# Chapter 4: Around the Global Scope

完全理解全局作用域对于掌握使用词法作用域来构建程序至关重要。

## Why Global Scope?

#### 背景

- JS 应用通常由多个文件组成，最终要**协同运行在同一个上下文中**。
- 这些文件之间需要一种机制来共享数据、调用方法。

------

#### ✅ 三种文件整合方式

1. **ES Modules（现代方式）**
   - 每个模块有独立作用域，通过 `import/export` 显式共享依赖。
   - 无需全局作用域协作。
   - 推荐使用。
2. **打包器（如 Webpack、Vite）**
   - 所有文件在构建阶段被合并成一个 JS 文件。
   - 通过闭包（例如 UMD）模拟应用级作用域。
   - 不污染全局作用域，但提供模块间互访的容器。
3. **传统 script 标签加载多个文件**
   - 每个 `.js` 文件都在**全局作用域中执行**。
   - 文件间的交互依赖 `window` 共享变量。
   - 易产生命名冲突，全局污染严重，不推荐。

------

#### ✅ Global Scope 的实际用途

- JavaScript 内建值都存在于全局作用域：
  - 例如：`undefined`, `NaN`, `Infinity`, `Object`, `Date`, `Math` 等。
- 浏览器/宿主环境提供的 API 也挂载在全局：
  - 例如：`console`, `setTimeout`, `document`, `navigator`, `window` 等。
- Node 环境下虽然有 `require`, `__dirname` 等全局使用的值，但它们**并不属于真正的 global scope**，是模块作用域注入的。

------

#### ❗ 总结观点

> 全局作用域不应被滥用，但它始终是 JS 应用中不可或缺的协作基础，尤其在非模块化或历史遗留代码中更为重要。